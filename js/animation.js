// Generated by CoffeeScript 1.3.3
(function() {

  define(['data'], function(Data) {
    var Animation;
    return Animation = (function() {

      function Animation(name, frames, interval, sprite) {
        this.name = name;
        this.sprite = sprite;
        this.ticks = 0;
        this.currentTimeout = null;
        this.frames = frames;
        this.interval = interval || 200;
      }

      Animation.prototype.start = function(nbLoops, callback) {
        this.nbLoops = nbLoops;
        this.callback = callback;
        this.stop();
        return this.tick();
      };

      Animation.prototype.tick = function() {
        var frameid,
          _this = this;
        frameid = this.frames[this.ticks++ % this.frames.length];
        this.sprite.setFrame(frameid);
        if (this.frames.length === 1) {
          return this.stop();
        }
        if ((this.nbLoops != null) && this.ticks === this.nbLoops * this.frames.length) {
          if (this.callback) {
            this.callback();
          }
          return this.stop();
        }
        return this.currentTimeout = setTimeout(function() {
          return _this.tick();
        }, this.interval);
      };

      Animation.prototype.stop = function() {
        this.ticks = 0;
        return clearTimeout(this.currentTimeout);
      };

      return Animation;

    })();
  });

}).call(this);
